{% extends "base.html" %}
{% block title %}Edit Expense{% endblock %}

{% block content %}
<div class="container-xl mt-4">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <form method="POST" enctype="multipart/form-data" class="card">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="card-header">
          <h3 class="card-title"><i class="ti ti-pencil me-2"></i> Edit Expense</h3>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label">Category</label>
            <select name="category" class="form-select" required>
              {% for cat in categories %}
                <option value="{{ cat }}" {% if expense.category == cat %}selected{% endif %}>{{ cat }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="mb-3">
            <label class="form-label">Amount ($)</label>
            <input type="number" name="amount" step="0.01" min="0" value="{{ expense.amount }}" class="form-control" required>
          </div>

          <div class="mb-3">
            <label class="form-label">Date</label>
            <input type="date" name="date" class="form-control" value="{{ expense.date.strftime('%Y-%m-%d') }}" required>
          </div>

          <div class="mb-3">
            <label class="form-label">Description (optional)</label>
            <textarea name="description" class="form-control" rows="2">{{ expense.description or '' }}</textarea>
          </div>

          {% if expense.receipt_filename %}
          <div class="mb-3">
            <label class="form-label">Current Receipt</label><br>
            <a href="{{ url_for('static', filename='uploads/receipts/' + expense.receipt_filename) }}" target="_blank">
              <i class="ti ti-file-search"></i> View Receipt
            </a>
          </div>
          {% endif %}

          <div class="mb-3">
            <label class="form-label">Replace Receipt (optional)</label>
            <input type="file" name="receipt" accept="image/*" class="form-control">
          </div>
        </div>

        <div class="card-footer text-end">
          <a href="{{ url_for('activity_expenses', activity_id=expense.activity_id) }}" class="btn btn-outline-secondary">Cancel</a>
          <button type="submit" class="btn btn-primary">
            <i class="ti ti-check me-1"></i> Save Changes
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
